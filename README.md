# _ß_ – eszett

**Explicit css scopes for react**

Inspired by styled-jsx. But build time only, so it works with server components.

```jsx
import eszett from "eszett";

async function Header() {
  return (
    <div className='header'>
      <h2>Hello World</h2>

      <style href={eszett} precedence="eszett">{`
        .${eszett} {
          &.header {
            background: blue;
          }

          h2& {
            color: white;
          }
        }
      `}</style>
    </header>
  );
}
```

## Install

```
npm install eszett
```

`eszett` is an [swc](https://swc.rs/docs/usage/swc-loader) plugin – so it should work wherever swc works. But I wrote this so I can use it for my nextjs projects so it is only tested with nextjs.

### With NextJs (requires nextjs 15)

In nextjs you can add it to your `next.config.js`:

```js
// next.config.js
module.exports = {
  …
  experimental: {
    swcPlugins: [["eszett/swc", {}]]
  }
}
```

## Usage

### Scope styles to a component

When you import eszett it will automatically add a unique class name to your html elements (Similar to the way styled-jsx works).
You can then style your component by adding a `<style></style>` tag to it.

Styles are not scoped by default but you have to explicitly scope them by adding the eszett scope to the selector:

```jsx
import eszett from 'eszett'

…

<style>
  .${eszett}.header {
    background-color: blue;
  }
</style>
```

You can also use [css nesting](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_nesting/Using_CSS_nesting) to save some typing:

```jsx
import eszett from 'eszett'

…

<style>
  .${eszett} {
    &.header {
      background-color: blue;
    }

    &.title {
      color: white;
    }
  }
</style>
```

### Styling nested components

Like styled-jsx, eszett will only add class names to native html elements or locally defined elements. But it will not automatically add a `className` prop to imported Components like `next/link`. But you can tag the class name with the `sz` helper to add scoped class names to those components too.

```jsx
import eszett, { sz } from 'eszett'
import Link from 'next/link'

async function Component() {
  return (
    <>
      <Link href='/home' className={sz`link`} />
      <style>
        .${eszett}.link {
          color: red;
        }
      </style>
    </>
  )
}
```

### Styling Children

Since you need to add "scope" explicitly, once you omit the eszett scope class your selectors become global again. This way you could write a component that applies styles to all its children without knowing what they are:

```jsx
import eszett, { sz } from 'eszett'
import Link from 'next/link'

async function Component(props) {
  return (
    <div className='wrapper'>
      {props.children}
      <style>
        .${eszett}.wrapper strong {
          color: red;
        }
      </style>
    </div>
  )
}
```

### Deduplicating Styles (requires react 19)

eszett does nothing special here but react can deduplicate styles when the style tag has a `href` and a `precedence`. (https://react.dev/reference/react-dom/components/style#special-rendering-behavior)

As long as you have a single style tag in your component can use the `eszett` variable as the href:

```jsx
import eszett from "eszett";

async function Header() {
  return (
    <div className='header'>
      <style href={eszett} precedence="eszett">{`
        .${eszett}.header {
          background: blue;
        }
      `}</style>
    </header>
  );
}
```

### How it Works

eszett generates a unique id for each react component rewrites the classNames of your html elements, and gives you two helper methods to access the scope name:

#### Rewriting classNames:

```jsx
// this input
import "eszett";
<div className="header" />;

// will be tranformed to:
<div className={"23u00ds-1" + " " + "header"} />;
```

#### Access the scope name as variable

```js
// this input
import eszett from "eszett";
console.log(eszett);

// will be transfomed to to:
console.log("23u00ds-1");
```

#### `sz` tagged template literal

```jsx
// this input
import { sz } from "eszett";
<Link className={sz`header`} />;

// will be tranformed to:
<Link className={"23u00ds-1" + " " + `header`} />;
```

> The eszett scope name is generated by hashing the file path of the component and incrementing a counter
> for each top level function in each file

Together with support for [`<style>` tags in react 19](https://react.dev/reference/react-dom/components/style) this is all we need to encapsulate our styles inside our components.

Since the scoping is very explicit you can decide for yourself if you use css nesting or css scope or just always write `.${eszett}.title` in your selectors. Maybe in the future I will update this to automatically add the scope class name to the styles and provide a `:global()` selector to opt out of scoping instead of explicitly opting in.

## Why eszett?

I wanted something that can be abbreviated to two letters (`sz`).  
A short form for "scoped css" but I did not like `sc`, `sx` was another option, but then I rememberd that the german letter ß is also called eszett and that is the name i picked.

Think of it as "scoped stylez" :-)
